<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="css/styles.css" />
    <link rel="stylesheet" href="https://cdn.simplecss.org/simple.css" />
    <link rel="icon" type="image/jpg" href="css/img/favicon.ico" />
    <title>Cliente - Tech Shop</title>
  </head>
  <body>
    <header>
      <ul id="listadoNav">
        <a href="/" class="logoContainer">
          <img src="css/img/logo.png" alt="" class="favicon" />
          <h5>Cliente</h5>
        </a>
        <div class="linksContainer">
          <a href="/carrito.html">
            <li class="links-header"><span>Carrito</span></li>
          </a>
        </div>
      </ul>
    </header>
    <hr />
    <h1>Productos disponibles</h1>
    <hr />
    <main id="contenedor-get">
      <div id="estudiantes-container">
        <ul id="estudiantes-lista"></ul>
      </div>
    </main>
    <script>
      async function obtenerDatosProductos() {
        try {
          let respuesta = await fetch(`http://localhost:3000/api/products`);
          if (!respuesta.ok) {
            throw new Error("Error al obtener los estudiantes");
          }
          let datos = await respuesta.json();
          return datos;
        } catch (error) {
          console.error("Error: ", error);
        }
      }

      function mostrarProductos(productos) {
        let productosLista = document.getElementById("estudiantes-lista");
        productosLista.innerHTML = "<p>Cargando estudiantes...</p>";
        if (!productos || productos.length === 0) {
          console.log("No hay estudiantes disponibles.");
          return;
        }
        let htmlEstudiantes = "";
        productos.forEach((producto) => {
          if (producto.is_active) {
            htmlEstudiantes += `
              <li class="cardProductos">
                <div class="cardGetProductosImgContainer">
                  <img src=${producto.image} alt=${
                        producto.name
                      } class="cardProductosImg">
                </div>
                <div class="cardProductosInfo">
                  <p>
                    Id: ${producto.id}
                  </p>
                  <h4>
                    ${producto.name}
                  </h4>
                  <h6>
                    $${producto.price}
                  </h6>
                  <div class="cardProductosButtons">
                    <button data-id="${producto.id}">Agregar al carrito</button>
                  </div>
                </div>
              </li>
            `;
          }
        });
        productosLista.innerHTML = htmlEstudiantes;
      }

      async function main() {
        let datos = await obtenerDatosProductos();
        mostrarProductos(datos);
      }

      main();
    </script>
  </body>
</html>
